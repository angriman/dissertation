\newcommand{\coorda}{2.7, 0}
\newcommand{\nodeida}{s1}

\newcommand{\coordb}{2.5, 1}
\newcommand{\nodeidb}{s2}

\newcommand{\coordc}{2.5, -1}
\newcommand{\nodeidc}{s3}

\newcommand{\coordd}{2, -1.6}
\newcommand{\nodeidd}{s4}

\newcommand{\coorde}{1, 0}
\newcommand{\nodeide}{s5}

\newcommand{\coordf}{.75, .6}
\newcommand{\nodeidf}{s6}

\newcommand{\coordg}{3, -2.2}
\newcommand{\nodeidg}{n1}

\newcommand{\coordh}{3.8, -0.8}
\newcommand{\nodeidh}{n2}

\newcommand{\coordi}{3.7, 0}
\newcommand{\nodeidi}{n3}

\newcommand{\coordj}{3.5, 0.7}
\newcommand{\nodeidj}{n4}

\newcommand{\coordk}{5, -2.1}
\newcommand{\nodeidk}{n5}

\newcommand{\coordl}{5.1, -1.5}
\newcommand{\nodeidl}{n6}

\newcommand{\coordm}{5.9, -0.8}
\newcommand{\nodeidm}{n7}

\newcommand{\coordn}{5.7, 0}
\newcommand{\nodeidn}{n8}

\newcommand{\coordo}{5.5, 1}
\newcommand{\nodeido}{n9}

\newcommand{\coordp}{7.5, -1.2}
\newcommand{\nodeidp}{n10}

\newcommand{\coordq}{7.7, 0}
\newcommand{\nodeidq}{n11}

\newcommand{\coordr}{7, 0.7}
\newcommand{\nodeidr}{n12}

\newcommand{\edgecoords}{
\path (s1) ++(0:\nshift) coordinate (sg1);
\path (s1) ++(-30:\nshift) coordinate (sg11);
\path (s1) ++(90:\nshift) coordinate (sg12);
\path (s1) ++(0:\nshift) coordinate (sg1);
\path (s2) ++(-20:\nshift) coordinate (sg2);
\path (s2) ++(180:\nshift) coordinate (sg2b);
\path (s2) ++(270:\nshift) coordinate (sg2bb);
\path (s3) ++(0:\nshift) coordinate (sg3);
\path (s3) ++(150:\nshift) coordinate (sg3b);
\path (s4) ++(-30:\nshift) coordinate (sg4);
\path (s5) ++(-30:\nshift) coordinate (sg5);
\path (s6) ++(15:\nshift) coordinate (sg6);

\path (n1) ++(150:\nshift) coordinate (ng1);
\path (n2) ++(180:\nshift) coordinate (ng2);
\path (n2) ++(150:\nshift) coordinate (ng21);
\path (n3) ++(180:\nshift) coordinate (ng3);
\path (n4) ++(165:\nshift) coordinate (ng4);
\path (n1) ++(0:\nshift) coordinate (ng1b);
\path (n2) ++(0:\nshift) coordinate (ng2b);
\path (n2) ++(30:\nshift) coordinate (ng2b1);
\path (n2) ++(-30:\nshift) coordinate (ng2b2);
\path (n3) ++(0:\nshift) coordinate (ng3b);
\path (n3) ++(30:\nshift) coordinate (ng3b1);

\path (n5) ++(180:\nshift) coordinate (ng5);
\path (n6) ++(150:\nshift) coordinate (ng6);
\path (n7) ++(180:\nshift) coordinate (ng7);
\path (n8) ++(180:\nshift) coordinate (ng8);
\path (n8) ++(210:\nshift) coordinate (ng81);
\path (n9) ++(210:\nshift) coordinate (ng9);

\path (n7) ++(-10:\nshift) coordinate (ng6b);
\path (n8) ++(0:\nshift) coordinate (ng7b);
\path (n8) ++(30:\nshift) coordinate (ng7b1);
\path (n9) ++(0:\nshift) coordinate (ng8b);

\path (n10) ++(160:\nshift) coordinate (ng10);
\path (n11) ++(180:\nshift) coordinate (ng11);
\path (n12) ++(210:\nshift) coordinate (ng12);
}

\tikzstyle{groupstyle}=[dashed, thick]
\tikzstyle{graphnode}=[circle,draw,thick]
\tikzstyle{every node}=[font=\small\itshape,inner sep=0, minimum size=.25cm, outer sep=0]

\newcommand{\grouplegend}{
\node[align=right] at (-1.25, .25) {$S$};
\draw[groupstyle,black] (-.75, .25) to (-.25, .25);
}
\newcommand{\graphlegend}{
\grouplegend
\node[align=right] at (-1.25, -.25) {\textnormal{DAG}};
\draw[black] (-.75, -.25) to (-.25, -.25);
}

\newcommand{\graphcoords}{
\coordinate[] (g1) at (0, 0);
\coordinate[] (g2) at (2, -2);
\coordinate[] (g3) at (4, -3);
\coordinate[] (g4) at (6, -2);
\coordinate[] (g5) at (8, -1);
\coordinate[] (g6) at (9, 0);
\coordinate[] (g7) at (7, 1);
\coordinate[] (g8) at (3, 1.2);
}

\newcommand{\graphcontour}{
\draw[] (g1) to[out=-90,in=180] (g2);
\draw[] (g2) to[out=0,in=180] (g3);
\draw[] (g2) to[out=0,in=180] (g3);
\draw[] (g3) to[out=0,in=200] (g4);
\draw[] (g4) to[out=30,in=240] (g5);
\draw[] (g5) to[out=60,in=-90] (g6);
\draw[] (g6) to[out=90,in=-30] (g7);
\draw[] (g7) to[out=150,in=-20] (g8);
\draw[] (g8) to[out=150,in=90] (g1);
}

\newcommand{\drawgraphcontour}{
\graphlegend
\graphcoords
\graphcontour
}

\newcommand{\drawgroupcontour}{
\coordinate[] (s1) at (3, 0);
\coordinate[] (s2) at (2, 0);
\coordinate[] (s4) at (2.5, 1.3);
\draw[dashed, thick] (s2) to[out=-90,in=180] ([yshift=5pt]g2);
\draw[dashed, thick] ([yshift=5pt]g2) to[out=0,in=-90] (s1);
\draw[dashed, thick] (s1) to[out=90,in=0] (s4);
\draw[dashed, thick] (s4) to[out=180,in=90] (s2);
}

\newcommand{\drawgroupsemilocaladdcontour}{
\coordinate[] (s1) at (4, -1);
\coordinate[] (s11) at (4, -.5);
\coordinate[] (s12) at (3, 0);
\coordinate[] (s2) at (2, 0);
\coordinate[] (s3) at (2.75, 1);
\coordinate[] (s4) at (2.25, 1.3);
\draw[dashed, thick] (s2) to[out=-90,in=180] ([yshift=5pt]g2);
\draw[dashed, thick] ([yshift=5pt]g2) to[out=0,in=-90] (s1);
\draw[dashed, thick] (s1) to[out=90,in=-90] (s11);
\draw[dashed, thick] (s11) to[out=120,in=-90] (s12);
\draw[dashed, thick] (s12) to[out=90,in=-90] (s3);
\draw[dashed, thick] (s3) to[out=90,in=0] (s4);
\draw[dashed, thick] (s4) to[out=200,in=90] (s2);
}

\newcommand{\drawgroupsemilocalremovecontour}{
\coordinate[] (s1) at (4, -1);
\coordinate[] (s11) at (4, -.7);
\coordinate[] (s12) at (3, 0);
\coordinate[] (s2) at (2.25, .3);
\draw[dashed, thick] (s2) to[out=200,in=180] ([yshift=5pt]g2);
\draw[dashed, thick] ([yshift=5pt]g2) to[out=0,in=-90] (s1);
\draw[dashed, thick] (s1) to[out=90,in=-90] (s11);
\draw[dashed, thick] (s11) to[out=120,in=0] (s2);
}

\newcommand{\drawswapgroupcontour}{
\coordinate[] (s1) at (4.5, -1);
\coordinate[] (s11) at (3.25, 0);
\coordinate[] (s2) at (2.3, 0);
\coordinate[] (s22) at (3, -1.2);
\coordinate[] (s23) at (1.75, -1.5);
\coordinate[] (s3) at (2.5, 1.3);
\draw[dashed, thick] (s23) to[out=-90,in=180] ([xshift=-5pt,yshift=2pt]g2);
\draw[dashed, thick] ([yshift=2pt]g2) to[out=0,in=-90] (s1);
\draw[dashed, thick] (s1) to[out=90,in=-90] (s11);
\draw[dashed, thick] (s11) to[out=90,in=0] (s3);
\draw[dashed, thick] (s3) to[out=180,in=150] (s2);
\draw[dashed, thick] (s2) to[out=-30,in=60] (s22);
\draw[dashed, thick] (s22) to[out=240,in=90] (s23);
}

\newcommand{\drawaddgroupcontour}{
\coordinate[] (s1) at (3, 0);
\coordinate[] (s12) at (6, -.2);
\coordinate[] (s13) at (6.1, .1);
\coordinate[] (s2) at (2, 0);
\coordinate[] (s3) at (2.75, 1);
\coordinate[] (s4) at (2.25, 1.3);
\draw[dashed, thick] (s2) to[out=-90,in=180] ([yshift=5pt]g2);
\draw[dashed, thick] ([yshift=5pt]g2) to[out=0,in=-90] (s1);
\draw[dashed, thick] (s1) to[out=90,in=240] (s12);
\draw[dashed, thick] (s12) to[out=60,in=270] (s13);
\draw[dashed, thick] (s13) to[out=90,in=-90] (s3);
\draw[dashed, thick] (s3) to[out=90,in=0] (s4);
\draw[dashed, thick] (s4) to[out=200,in=90] (s2);
}
